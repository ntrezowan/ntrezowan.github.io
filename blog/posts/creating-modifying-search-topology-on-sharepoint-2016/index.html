<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
  Creating/Modifying Search Topology on SharePoint 2016 · johndoeyo
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="John De">
<meta name="description" content="Hostname Role Components App1 Application Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics App2 Application Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics Web1 Web Front Indexing, Query Processing Web2 Web Front Indexing, Query Processing A. Configuring a new Search Topology Link to heading Create a new Search application Search Service Application with database name SharePoint_Search; $ssa = New-SPEnterpriseSearchServiceApplication -Name &#34;Search Service Application&#34; -DatabaseName &#34;SharePoint_Search&#34; -ApplicationPool &#34;Search Service AppPool&#34; -AdminApplicationPool &#34;Search Service AdminAppPool&#34; Create a new proxy for Search application Search Service Application Proxy; New-SPEnterpriseSearchServiceApplicationProxy -Name &#34;Search Service Application Proxy&#34; -SearchApplication $ssa Save the Search Service Application into a variable; $ssa = Get-SPEnterpriseSearchServiceApplication Define variables (hostA, hostB&hellip;) for each servers that will be included in the Search topology; $hostA = Get-SPEnterpriseSearchServiceInstance | ?">
<meta name="keywords" content="blog,developer,personal">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Creating/Modifying Search Topology on SharePoint 2016"/>
<meta name="twitter:description" content="Hostname Role Components App1 Application Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics App2 Application Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics Web1 Web Front Indexing, Query Processing Web2 Web Front Indexing, Query Processing A. Configuring a new Search Topology Link to heading Create a new Search application Search Service Application with database name SharePoint_Search; $ssa = New-SPEnterpriseSearchServiceApplication -Name &#34;Search Service Application&#34; -DatabaseName &#34;SharePoint_Search&#34; -ApplicationPool &#34;Search Service AppPool&#34; -AdminApplicationPool &#34;Search Service AdminAppPool&#34; Create a new proxy for Search application Search Service Application Proxy; New-SPEnterpriseSearchServiceApplicationProxy -Name &#34;Search Service Application Proxy&#34; -SearchApplication $ssa Save the Search Service Application into a variable; $ssa = Get-SPEnterpriseSearchServiceApplication Define variables (hostA, hostB&hellip;) for each servers that will be included in the Search topology; $hostA = Get-SPEnterpriseSearchServiceInstance | ?"/>

<meta property="og:title" content="Creating/Modifying Search Topology on SharePoint 2016" />
<meta property="og:description" content="Hostname Role Components App1 Application Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics App2 Application Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics Web1 Web Front Indexing, Query Processing Web2 Web Front Indexing, Query Processing A. Configuring a new Search Topology Link to heading Create a new Search application Search Service Application with database name SharePoint_Search; $ssa = New-SPEnterpriseSearchServiceApplication -Name &#34;Search Service Application&#34; -DatabaseName &#34;SharePoint_Search&#34; -ApplicationPool &#34;Search Service AppPool&#34; -AdminApplicationPool &#34;Search Service AdminAppPool&#34; Create a new proxy for Search application Search Service Application Proxy; New-SPEnterpriseSearchServiceApplicationProxy -Name &#34;Search Service Application Proxy&#34; -SearchApplication $ssa Save the Search Service Application into a variable; $ssa = Get-SPEnterpriseSearchServiceApplication Define variables (hostA, hostB&hellip;) for each servers that will be included in the Search topology; $hostA = Get-SPEnterpriseSearchServiceInstance | ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.example.com/posts/creating-modifying-search-topology-on-sharepoint-2016/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-06-12T01:18:37-05:00" />
<meta property="article:modified_time" content="2017-06-12T01:18:37-05:00" />




<link rel="canonical" href="http://www.example.com/posts/creating-modifying-search-topology-on-sharepoint-2016/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.36f76aaf39a14ecf5c3a3c6250dcaf06c238b3d8365d17d646f95cb1874e852b.css" integrity="sha256-NvdqrzmhTs9cOjxiUNyvBsI4s9g2XRfWRvlcsYdOhSs=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.593028e7f7ac55c003b79c230d1cd411bb4ca53b31556c3abb7f027170e646e9.css" integrity="sha256-WTAo5/esVcADt5wjDRzUEbtMpTsxVWw6u38CcXDmRuk=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">




<meta name="generator" content="Hugo 0.110.0">





  </head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      johndoeyo
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Blog</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://www.example.com/posts/creating-modifying-search-topology-on-sharepoint-2016/">
              Creating/Modifying Search Topology on SharePoint 2016
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2017-06-12T01:18:37-05:00">
                Jun 12, 2017
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              3-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <table>
<thead>
<tr>
<th>Hostname</th>
<th>Role</th>
<th>Components</th>
</tr>
</thead>
<tbody>
<tr>
<td>App1</td>
<td>Application</td>
<td>Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics</td>
</tr>
<tr>
<td>App2</td>
<td>Application</td>
<td>Admin, Crawl, Content Processing, Indexing, Query Processing, Analytics</td>
</tr>
<tr>
<td>Web1</td>
<td>Web Front</td>
<td>Indexing, Query Processing</td>
</tr>
<tr>
<td>Web2</td>
<td>Web Front</td>
<td>Indexing, Query Processing</td>
</tr>
</tbody>
</table>
<h3 id="a-configuring-a-new-search-topology">
  A. Configuring a new Search Topology
  <a class="heading-link" href="#a-configuring-a-new-search-topology">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ol>
<li>Create a new Search application <code>Search Service Application</code> with database name <code>SharePoint_Search</code>;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ssa = New-SPEnterpriseSearchServiceApplication -Name &#34;Search Service Application&#34; -DatabaseName &#34;SharePoint_Search&#34; -ApplicationPool &#34;Search Service AppPool&#34; -AdminApplicationPool &#34;Search Service AdminAppPool&#34;
</span></span></code></pre></div><ol start="2">
<li>Create a new proxy for Search application <code>Search Service Application Proxy</code>;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>New-SPEnterpriseSearchServiceApplicationProxy -Name &#34;Search Service Application Proxy&#34; -SearchApplication $ssa
</span></span></code></pre></div><ol start="3">
<li>Save the Search Service Application into a variable;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ssa = Get-SPEnterpriseSearchServiceApplication
</span></span></code></pre></div><ol start="4">
<li>Define variables (hostA, hostB&hellip;) for each servers that will be included in the Search topology;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$hostA = Get-SPEnterpriseSearchServiceInstance | ?{$_.Server -match &#34;App1&#34;}
</span></span><span style="display:flex;"><span>$hostB = Get-SPEnterpriseSearchServiceInstance | ?{$_.Server -match &#34;App2&#34;}
</span></span><span style="display:flex;"><span>$hostC = Get-SPEnterpriseSearchServiceInstance | ?{$_.Server -match “Web1&#34;}
</span></span><span style="display:flex;"><span>$hostD = Get-SPEnterpriseSearchServiceInstance | ?{$_.Server -match &#34;Web2&#34;}
</span></span></code></pre></div><ol start="5">
<li>Start Search Service in all the servers that will be included in the Search topology;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Start-SPEnterpriseSearchServiceInstance -Identity $hostA
</span></span><span style="display:flex;"><span>Start-SPEnterpriseSearchServiceInstance -Identity $hostB
</span></span><span style="display:flex;"><span>Start-SPEnterpriseSearchServiceInstance -Identity $hostC
</span></span><span style="display:flex;"><span>Start-SPEnterpriseSearchServiceInstance -Identity $hostD
</span></span></code></pre></div><ol start="6">
<li>Verify that Search instance is running in all the servers;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Get-SPEnterpriseSearchServiceInstance -Identity $hostA
</span></span><span style="display:flex;"><span>Get-SPEnterpriseSearchServiceInstance -Identity $hostB
</span></span><span style="display:flex;"><span>Get-SPEnterpriseSearchServiceInstance -Identity $hostC
</span></span><span style="display:flex;"><span>Get-SPEnterpriseSearchServiceInstance -Identity $hostD
</span></span></code></pre></div><ol start="7">
<li>Clone current active topology;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$clone = $sa.ActiveTopology.Clone()
</span></span></code></pre></div><ol start="8">
<li>Configure <code>App1</code> and <code>App2</code> to have Admin, Crawl, Content Processing, Indexing, Query Processing and Analytics;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>New-SPEnterpriseSearchAdminComponent -SearchTopology $newTopology -SearchServiceInstance $hostA
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchCrawlComponent -SearchTopology $newTopology -SearchServiceInstance $hostA
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchContentProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostA
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchAnalyticsProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostA
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchQueryProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostA
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchIndexComponent -SearchTopology $newTopology -SearchServiceInstance $hostA -IndexPartition 0
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>New-SPEnterpriseSearchAdminComponent -SearchTopology $newTopology -SearchServiceInstance $hostB
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchCrawlComponent -SearchTopology $newTopology -SearchServiceInstance $hostB
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchContentProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostB
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchAnalyticsProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostB
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchQueryProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostB
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchIndexComponent -SearchTopology $newTopology -SearchServiceInstance $hostB -IndexPartition 0
</span></span></code></pre></div><ol start="9">
<li>Configure <code>Web1</code> and <code>Web2</code> to have Query Processing and Indexing;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>New-SPEnterpriseSearchQueryProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostC
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchIndexComponent -SearchTopology $newTopology -SearchServiceInstance $hostC -IndexPartition 0
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>New-SPEnterpriseSearchQueryProcessingComponent -SearchTopology $newTopology -SearchServiceInstance $hostD
</span></span><span style="display:flex;"><span>New-SPEnterpriseSearchIndexComponent -SearchTopology $newTopology -SearchServiceInstance $hostD -IndexPartition 0
</span></span></code></pre></div><ol start="10">
<li>Activate clone topology;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$clone.Activate()
</span></span></code></pre></div><ol start="11">
<li>
<p>Go to <code>CA &gt; General Application Settings &gt; Farm Search Administration &gt; Search Server Application</code>. All the servers will be listed under Search Application Topology.</p>
</li>
<li>
<p>Verify the topology;</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Get-SPEnterpriseSearchTopology -SearchApplication $ssa
</span></span></code></pre></div><p>This will print all the topologies including the inactive one.</p>
<ol start="13">
<li>Check the status of the index components;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Get-SPEnterpriseSearchStatus -SearchApplication $ssa -Text
</span></span></code></pre></div><ol start="14">
<li>To remove inactive topologies, run the following command;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Get-SPEnterpriseSearchServiceApplication | Get-SPEnterpriseSearchTopology |? {$_.State -eq &#34;Inactive&#34;} |% { Remove-SPEnterpriseSearchTopology -Identity $_ -Confirm:$false}
</span></span></code></pre></div><hr>
<h3 id="b-modifying-an-existing-search-topology">
  B. Modifying an existing Search Topology
  <a class="heading-link" href="#b-modifying-an-existing-search-topology">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ol>
<li>Save active search topology into a variable;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ssa = Get-SPEnterpriseSearchServiceApplication
</span></span><span style="display:flex;"><span>$active = Get-SPEnterpriseSearchTopology -SearchApplication $ssa -Active
</span></span></code></pre></div><ol start="2">
<li>Clone the active topology;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$clone = New-SPEnterpriseSearchTopology -SearchApplication $ssa -Clone -SearchTopology $active
</span></span></code></pre></div><ol start="3">
<li>Wait for indexes to be replicated and then we can remove old index component from the clone topology. To remove old index, we need to find <code>ComponentId</code>. Run the following command to find <code>ComponentId</code> of the server under the clone topology;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Get-SPEnterpriseSearchComponent -SearchTopology $clone
</span></span></code></pre></div><p>For example, App2 will have an index with ComponentId, <code>c8309775-dcf3-4a07-8598-05dbc98b04b0</code>.</p>
<ol start="4">
<li>Run the following command to remove the index from the server;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Remove-SPEnterpriseSearchComponent -Identity &#39;c8309775-dcf3-4a07-8598-05dbc98b04b0&#39; -SearchTopology $clone
</span></span></code></pre></div><ol start="5">
<li>Activate the new cloned topology;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$clone.Activate()
</span></span></code></pre></div><ol start="6">
<li>To remove inactive topologies, run the following command;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Get-SPEnterpriseSearchServiceApplication | Get-SPEnterpriseSearchTopology |? {$_.State -eq &#34;Inactive&#34;} |% { Remove-SPEnterpriseSearchTopology -Identity $_ -Confirm:$false}
</span></span></code></pre></div><hr>
<p><strong>Changing Index path</strong></p>
<p>Default index location is at <code>C:\Program Files\Microsoft Office Servers\16.0\Data\Office Server\Applications</code> which may create issue since it&rsquo;s reading/writing to a slow I/O hard disk. To change the location and move it to a flash drive, run the following command;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>New-SPEnterpriseSearchIndexComponent -SearchTopology $clone -SearchServiceInstance $ssa -IndexPartition 0 -RootDirectory Z:\FlashDrive\Index\0
</span></span></code></pre></div><p>We need to run this command before activing the topology.</p>

      </div>


      <footer>
        


        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2023
     John De 
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  
</body>

</html>
